<?php

class report_budget_plan_m extends CI_Model {

    function get_sales_by_category($INT_ID_FISCAL_YEAR,$CHR_BUDGET_CATEGORY){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_SALES
            WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_BUDGET_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC")->row();
    }
    
    function get_dimat_by_category($INT_ID_FISCAL_YEAR, $CHR_BUDGET_CATEGORY){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_DIRECT_MATERIAL
            WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_BUDGET_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC
            ORDER BY CHR_BUDGET_CATEGORY")->row();
    }
    
    function get_nopin_by_category($INT_ID_FISCAL_YEAR, $CHR_BUDGET_CATEGORY){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_NON_OPERATING_INCOME
            WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_BUDGET_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC
            ORDER BY CHR_BUDGET_CATEGORY")->row();
    }
    
    function get_tax_by_category($INT_ID_FISCAL_YEAR, $CHR_BUDGET_CATEGORY){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_TAX
            WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_BUDGET_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC
            ORDER BY CHR_BUDGET_CATEGORY")->row();
    }
    
    function get_expense_by_category($INT_ID_FISCAL_YEAR, $CHR_BUDGET_CATEGORY){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                          SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                          SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_BUDGET_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC
                                    UNION
                                    SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                              SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                              SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                              SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                              SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_BUDGET_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC) AS SUMMARY_TABLE
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC
                                    ORDER BY CHR_BUDGET_CATEGORY")->row();
    }
    
//====================== CALCULATION FOR PROFIT AND LOSS =====================//
    function tot_sales_aii($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                      ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                      ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                      ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_SALES
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = 'SAL3001') AND (CHR_STAT_REV = '$CHR_STAT_REV')")->row();
    }
    
    function tot_dimat_aii($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                      ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                      ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                      ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_DIRECT_MATERIAL
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('DMA4001','DMA4002','DMA4003','DMA4004')) AND (CHR_STAT_REV = '$CHR_STAT_REV')")->row();
    }
    
    function tot_direct_labor($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT   ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                          ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                          ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                          ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM (SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = 'FOH5004') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    UNION
                                    SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                              SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                              SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                              SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = 'FOH5004') AND (CHR_STAT_REV = '$CHR_STAT_REV')) AS SUMMARY_TABLE")->row();
    }
    
    function tot_foh($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT   ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                          ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                          ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                          ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM (SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('FOH5001','FOH5002','FOH5003','FOH5005','FOH5006','FOH5007','FOH5008','FOH5009','FOH5010','FOH5011','FOH5012','FOH5013','FOH5014','FOH5015','FOH5016','FOH5017','FOH5018','FOH5019','FOH5020','FOH5021','FOH5022','FOH5023','FOH5024','FOH5025')) AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    UNION
                                    SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                              SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                              SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                              SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('FOH5001','FOH5002','FOH5003','FOH5005','FOH5006','FOH5007','FOH5008','FOH5009','FOH5010','FOH5011','FOH5012','FOH5013','FOH5014','FOH5015','FOH5016','FOH5017','FOH5018','FOH5019','FOH5020','FOH5021','FOH5022','FOH5023','FOH5024','FOH5025')) AND (CHR_STAT_REV = '$CHR_STAT_REV')) AS SUMMARY_TABLE")->row();
    }
    
    function tot_opx($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT   ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                          ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                          ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                          ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM (SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('OPX6001','OPX6002','OPX6003','OPX6004','OPX6005','OPX6006','OPX6007','OPX6008','OPX6009','OPX6010','OPX6011','OPX6012','OPX6013','OPX6014','OPX6015','OPX6016','OPX6017','OPX6018','OPX6019','OPX6020','OPX6021','OPX6022','OPX6023','OPX6024','OPX6025')) AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    UNION
                                    SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                              SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                              SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                              SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('OPX6001','OPX6002','OPX6003','OPX6004','OPX6005','OPX6006','OPX6007','OPX6008','OPX6009','OPX6010','OPX6011','OPX6012','OPX6013','OPX6014','OPX6015','OPX6016','OPX6017','OPX6018','OPX6019','OPX6020','OPX6021','OPX6022','OPX6023','OPX6024','OPX6025')) AND (CHR_STAT_REV = '$CHR_STAT_REV')) AS SUMMARY_TABLE")->row();
    }
    
    function tot_other_income($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                      ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                      ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                      ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_NON_OPERATING_INCOME
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = 'NON7049') AND (CHR_STAT_REV = '$CHR_STAT_REV')")->row();
    }
    
    function tot_opin_tooling_aii($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT   ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                      ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                      ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                      ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM (SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_SALES
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = 'SAL3003') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                UNION
                                SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_DIRECT_MATERIAL
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = 'DMA4005') AND (CHR_STAT_REV = '$CHR_STAT_REV')) AS SUMMARY_TABLE")->row();
    }
    
    function tot_opin_passthru_aiia($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT   ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                      ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                      ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                      ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM (SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_SALES
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = 'SAL3002') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                UNION
                                SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_DIRECT_MATERIAL
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = 'DMA4006') AND (CHR_STAT_REV = '$CHR_STAT_REV')) AS SUMMARY_TABLE")->row();
    }
    
    function tot_opin_tooling_aiia($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT   ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                      ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                      ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                      ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM (SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_SALES
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = 'SAL3004') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                UNION
                                SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_DIRECT_MATERIAL
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = 'DMA4007') AND (CHR_STAT_REV = '$CHR_STAT_REV')) AS SUMMARY_TABLE")->row();
    }
    
    function tot_nopin($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                          ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                          ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                          ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_NON_OPERATING_INCOME
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('NON7010','NON7030','NON8010','NON8020')) AND (CHR_STAT_REV = '$CHR_STAT_REV')")->row();
    }
    
    function tot_tax($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                          ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                          ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                          ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_TAX
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('TAX8801','TAX8803')) AND (CHR_STAT_REV = '$CHR_STAT_REV')")->row();
    }
    
    function tot_sub_material($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT   ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                          ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                          ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                          ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM (SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('FOH5001','FOH5002','FOH5003')) AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    UNION
                                    SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                              SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                              SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                              SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('FOH5001','FOH5002','FOH5003')) AND (CHR_STAT_REV = '$CHR_STAT_REV')) AS SUMMARY_TABLE")->row();
    }
    
    function tot_other_variable($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT   ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                          ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                          ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                          ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM (SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('FOH5004','FOH5005','FOH5006','FOH5007','FOH5008','FOH5009','OPX6001','OPX6002')) AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    UNION
                                    SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                              SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                              SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                              SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('FOH5004','FOH5005','FOH5006','FOH5007','FOH5008','FOH5009','OPX6001','OPX6002')) AND (CHR_STAT_REV = '$CHR_STAT_REV')) AS SUMMARY_TABLE")->row();
    }
    
    function tot_fixed_cost($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT   ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                          ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                          ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                          ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM (SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('FOH5010','FOH5011','FOH5012','FOH5013','FOH5014','FOH5015','FOH5016','FOH5017','FOH5018','FOH5019','FOH5020','FOH5021','FOH5022','FOH5023','FOH5024','FOH5025')) AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    UNION
                                    SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                              SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                              SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                              SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('FOH5010','FOH5011','FOH5012','FOH5013','FOH5014','FOH5015','FOH5016','FOH5017','FOH5018','FOH5019','FOH5020','FOH5021','FOH5022','FOH5023','FOH5024','FOH5025')) AND (CHR_STAT_REV = '$CHR_STAT_REV')) AS SUMMARY_TABLE")->row();
    }
    
    function tot_sga_cost($INT_ID_FISCAL_YEAR){
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT   ISNULL(SUM(MON_AMT_BLN01),0) AS MON_AMT_BLN01, ISNULL(SUM(MON_AMT_BLN02),0) AS MON_AMT_BLN02, ISNULL(SUM(MON_AMT_BLN03),0) AS MON_AMT_BLN03, ISNULL(SUM(MON_AMT_BLN04),0) AS MON_AMT_BLN04, 
                                          ISNULL(SUM(MON_AMT_BLN05),0) AS MON_AMT_BLN05, ISNULL(SUM(MON_AMT_BLN06),0) AS MON_AMT_BLN06, ISNULL(SUM(MON_AMT_BLN07),0) AS MON_AMT_BLN07, ISNULL(SUM(MON_AMT_BLN08),0) AS MON_AMT_BLN08, 
                                          ISNULL(SUM(MON_AMT_BLN09),0) AS MON_AMT_BLN09, ISNULL(SUM(MON_AMT_BLN10),0) AS MON_AMT_BLN10, ISNULL(SUM(MON_AMT_BLN11),0) AS MON_AMT_BLN11, ISNULL(SUM(MON_AMT_BLN12),0) AS MON_AMT_BLN12, 
                                          ISNULL(SUM(MON_AMT_SUM),0) AS MON_AMT_SUM
                                FROM (SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                          SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                          SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                          SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('OPX6003','OPX6004','OPX6005','OPX6006','OPX6007','OPX6008','OPX6009','OPX6010','OPX6011','OPX6012','OPX6013','OPX6014','OPX6015','OPX6016','OPX6017','OPX6018','OPX6019','OPX6020','OPX6021','OPX6022','OPX6023','OPX6024','OPX6025')) AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    UNION
                                    SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                              SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                              SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                              SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY IN ('OPX6003','OPX6004','OPX6005','OPX6006','OPX6007','OPX6008','OPX6009','OPX6010','OPX6011','OPX6012','OPX6013','OPX6014','OPX6015','OPX6016','OPX6017','OPX6018','OPX6019','OPX6020','OPX6021','OPX6022','OPX6023','OPX6024','OPX6025')) AND (CHR_STAT_REV = '$CHR_STAT_REV')) AS SUMMARY_TABLE")->row();
    }
    
    function get_summary_sales_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                        CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_SALES
            WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC")->result();
    }
    
    function tot_summary_sales_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR, 
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_SALES
            WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY INT_ID_FISCAL_YEAR")->result();
    }
    
    function get_summary_dimat_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                        CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_DIRECT_MATERIAL
            WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC")->result();
    }
    
    function tot_summary_dimat_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_DIRECT_MATERIAL
            WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY INT_ID_FISCAL_YEAR")->result();
    }
    
    function get_summary_nopin_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                        CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_NON_OPERATING_INCOME
            WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC")->result();
    }
    
    function tot_summary_nopin_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_NON_OPERATING_INCOME
            WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY INT_ID_FISCAL_YEAR")->result();
    }
    
    function get_summary_tax_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                        CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_TAX
            WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC")->result();
    }
    
    function tot_summary_tax_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR,
                      SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                      SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                      SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                      SUM(MON_AMT_SUM) AS MON_AMT_SUM
            FROM CPL.TT_BUDGET_TAX
            WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (CHR_STAT_REV = '$CHR_STAT_REV')
            GROUP BY INT_ID_FISCAL_YEAR")->result();
    }
    
    function get_summary_expense_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                                    CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC
                                UNION
                                SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                                    CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC")->result();
    }
    
    function get_summary_expense_company_cpl($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                                    CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC
                                UNION
                                SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                                    CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC")->result();
    }
    
    function tot_summary_expense_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR, 
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                                    CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC
                                UNION
                                SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                                    CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC) AS SUMMARY_EXPENSE
                                GROUP BY INT_ID_FISCAL_YEAR")->result();
    }
    
    function tot_summary_expense_company_cpl($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT INT_ID_FISCAL_YEAR, 
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                                    CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC
                                UNION
                                SELECT INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, 
                                    CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY INT_ID_FISCAL_YEAR, CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, CHR_CODE_CATEGORY_A3, CHR_CODE_CATEGORY_A3_DESC) AS SUMMARY_EXPENSE
                                GROUP BY INT_ID_FISCAL_YEAR")->result();
    }
    
    function get_summary_expense_foh($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC
                                UNION
                                SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC, 
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC")->result();
    }
    
    function get_summary_expense_foh_cpl($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV') 
                                GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC
                                UNION
                                SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC, 
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC")->result();
    }

    function get_summary_expense_foh_total($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                    SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC
                                    UNION
                                    SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC,
                                            SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                            SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                            SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                            SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC) AS TABLE_SUMMARY_OPX")->result();
    }
    
    function get_summary_expense_foh_total_cpl($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                    SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC
                                    UNION
                                    SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC,
                                            SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                            SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                            SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                            SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC) AS TABLE_SUMMARY_OPX")->result();
    }

    function get_summary_expense_opx($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC, 
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC
                                UNION
                                SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC")->result();
    }
    
    function get_summary_expense_opx_cpl($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC, 
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC
                                UNION
                                SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_CATEGORY_DESC")->result();
    }

    function get_summary_expense_opx_total($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                    SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC
                                    UNION
                                    SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC,
                                            SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                            SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                            SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                            SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC) AS TABLE_SUMMARY_OPX")->result();
    }
    
    function get_summary_expense_opx_total_cpl($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                    SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE
                                    WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC
                                    UNION
                                    SELECT CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC,
                                            SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                            SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                            SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                            SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                    FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                    WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                    GROUP BY CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC) AS TABLE_SUMMARY_OPX")->result();
    }
    
    function get_expense_foh_by_category($INT_ID_FISCAL_YEAR, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_foh_by_category_cpl($INT_ID_FISCAL_YEAR, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_opx_by_category($INT_ID_FISCAL_YEAR, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_opx_by_category_cpl($INT_ID_FISCAL_YEAR, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_foh_by_category_per_dept($INT_ID_FISCAL_YEAR, $INT_DEPT, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_DEPT = '$INT_DEPT') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_DEPT = '$INT_DEPT') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_foh_by_category_per_dept_cpl($INT_ID_FISCAL_YEAR, $INT_DEPT, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_DEPT = '$INT_DEPT') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_DEPT = '$INT_DEPT') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_opx_by_category_per_dept($INT_ID_FISCAL_YEAR, $INT_DEPT, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_DEPT = '$INT_DEPT') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_DEPT = '$INT_DEPT') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_opx_by_category_per_dept_cpl($INT_ID_FISCAL_YEAR, $INT_DEPT, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_DEPT = '$INT_DEPT') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_DEPT = '$INT_DEPT') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_foh_by_category_per_group($INT_ID_FISCAL_YEAR, $INT_GROUP, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_GROUP_DEPT = '$INT_GROUP') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_GROUP_DEPT = '$INT_GROUP') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_foh_by_category_per_group_cpl($INT_ID_FISCAL_YEAR, $INT_GROUP, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_GROUP_DEPT = '$INT_GROUP') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'FOH%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_GROUP_DEPT = '$INT_GROUP') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_opx_by_category_per_group($INT_ID_FISCAL_YEAR, $INT_GROUP, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_GROUP_DEPT = '$INT_GROUP') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_GROUP_DEPT = '$INT_GROUP') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_expense_opx_by_category_per_group_cpl($INT_ID_FISCAL_YEAR, $INT_GROUP, $CHR_CATEGORY) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM (SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_GROUP_DEPT = '$INT_GROUP') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC
                                UNION
                                SELECT CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_EXPENSE_AMOUNT
                                WHERE (CHR_BUDGET_CATEGORY like 'OPX%') AND (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (INT_GROUP_DEPT = '$INT_GROUP') AND (CHR_BUDGET_CATEGORY = '$CHR_CATEGORY') AND (CHR_FLAG_APP_GM = '1') AND (CHR_STAT_REV = '$CHR_STAT_REV')
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC) AS SUMMARY_TABLE
                                GROUP BY CHR_CODE_CATEGORY_A3_DESC, CHR_BUDGET_CATEGORY_DESC, CHR_BUDGET_SUB_CATEGORY_DESC")->result();
    }
    
    function get_summary_capex_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, 
                                        CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, '-' AS CHR_CODE_CATEGORY_A3, '-' AS CHR_CODE_CATEGORY_A3_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_CAPEX
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (BIT_FLG_DEL = '0')
                                GROUP BY CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC,CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC")->result();
    }
    
    function get_summary_capex_company_cpl($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC, 
                                        CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC, '-' AS CHR_CODE_CATEGORY_A3, '-' AS CHR_CODE_CATEGORY_A3_DESC,
                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_CAPEX
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (BIT_FLG_DEL = '0') AND (CHR_FLAG_APP_GM = '1')
                                GROUP BY CHR_BUDGET_TYPE, CHR_BUDGET_TYPE_DESC, CHR_BUDGET_SUB_CATEGORY, CHR_BUDGET_SUB_CATEGORY_DESC,CHR_BUDGET_CATEGORY, CHR_BUDGET_CATEGORY_DESC")->result();
    }
    
//    function get_summary_capex_company($INT_ID_FISCAL_YEAR) {
//        return $this->db->query("SELECT CHR_DIVISION, CHR_GROUP_DEPT, CHR_DEPT, 
//                                        SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
//                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
//                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
//                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
//                                FROM CPL.TT_BUDGET_CAPEX
//                                LEFT JOIN TM_DIVISION ON CPL.TT_BUDGET_CAPEX.INT_DIV = TM_DIVISION.INT_ID_DIVISION
//                                LEFT JOIN TM_GROUP_DEPT ON CPL.TT_BUDGET_CAPEX.INT_GROUP_DEPT = TM_GROUP_DEPT.INT_ID_GROUP_DEPT
//                                LEFT JOIN TM_DEPT ON CPL.TT_BUDGET_CAPEX.INT_DEPT = TM_DEPT.INT_ID_DEPT
//                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (CPL.TT_BUDGET_CAPEX.BIT_FLG_DEL = '0')
//                                GROUP BY CHR_DIVISION, CHR_GROUP_DEPT, CHR_DEPT")->result();
//    }
    
    function tot_summary_capex_company($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_CAPEX
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (BIT_FLG_DEL = '0')")->result();
    }
    
    function tot_summary_capex_company_cpl($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT SUM(MON_AMT_BLN01) AS MON_AMT_BLN01, SUM(MON_AMT_BLN02) AS MON_AMT_BLN02, SUM(MON_AMT_BLN03) AS MON_AMT_BLN03, SUM(MON_AMT_BLN04) AS MON_AMT_BLN04, 
                                        SUM(MON_AMT_BLN05) AS MON_AMT_BLN05, SUM(MON_AMT_BLN06) AS MON_AMT_BLN06, SUM(MON_AMT_BLN07) AS MON_AMT_BLN07, SUM(MON_AMT_BLN08) AS MON_AMT_BLN08, 
                                        SUM(MON_AMT_BLN09) AS MON_AMT_BLN09, SUM(MON_AMT_BLN10) AS MON_AMT_BLN10, SUM(MON_AMT_BLN11) AS MON_AMT_BLN11, SUM(MON_AMT_BLN12) AS MON_AMT_BLN12, 
                                        SUM(MON_AMT_SUM) AS MON_AMT_SUM
                                FROM CPL.TT_BUDGET_CAPEX
                                WHERE (INT_ID_FISCAL_YEAR = '$INT_ID_FISCAL_YEAR') AND (BIT_FLG_DEL = '0') AND (CHR_FLAG_APP_GM = '1')")->result();
    }
    
    function get_detail_capex($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT * from  CPL.TT_BUDGET_CAPEX WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (BIT_FLG_DEL = '0')")->result();
    }
    
    function get_detail_capex_cpl($INT_ID_FISCAL_YEAR) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT * from  CPL.TT_BUDGET_CAPEX WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (BIT_FLG_DEL = '0') AND (CHR_FLAG_APP_GM = '1')")->result();
    }
    
    function get_detail_capex_dept($INT_ID_FISCAL_YEAR, $INT_DEPT) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT * from  CPL.TT_BUDGET_CAPEX WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (INT_DEPT = $INT_DEPT) AND (BIT_FLG_DEL = '0')")->result();
    }
    
    function get_detail_capex_dept_cpl($INT_ID_FISCAL_YEAR, $INT_DEPT) {
        $CHR_STAT_REV = 'RMB';
        return $this->db->query("SELECT * from  CPL.TT_BUDGET_CAPEX WHERE (INT_ID_FISCAL_YEAR = $INT_ID_FISCAL_YEAR) AND (INT_DEPT = $INT_DEPT) AND (BIT_FLG_DEL = '0') AND (CHR_FLAG_APP_GM = '1')")->result();
    }

    

}

?>
